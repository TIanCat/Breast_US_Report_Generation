# Development and Evaluation of AI System for Breast Ultrasound Report Generation: A Retrospective, Multicentre, Cohort Study

Jian Wang,
Jinfeng Xu,
Xin Yang,
Huaiyu Wu,
Xiliang Zhu,
Rusi Chen,
Ao Chang,
Yanlin Chen,
Haoran Dou,
Ruobing Huang,
Jun Cheng,
Yongsong Zhou,
Rui Gao,
Keen Yang,
Guoqiu Li,
Jing Chen,
Hongtian Tian,
Ning Gu,
Fajin Dong,
Dong Ni

**Abstrct:** In this retrospective multicenter study, we aimed to develop and evaluate an AI system that automatically generates BUS reports from multi-modality and multi-view US images (Fig.\ref{fig:framework}). The system was developed and quantitatively evaluated on a large-scale dataset (including over 100,000 cases) collected from the main center. Qualitative evaluations were performed on external test sets collected from two other centers. The core of the evaluation is to determine the diagnostic capabilities of the AI system and its value to radiologists.
![image](https://github.com/TIanCat/Breast_US_Report_Generation/blob/main/figure/framework.png)
The overall design of this study. (a) The developed system consists of the finding and impression models, which were used to generate findings and impressions of BUS reports from multi-modality and multi-view US images. (b) Similarity measurement between AI-generated reports and radiologist-written reports. (c) Malignancy risk assessment for each BI-RADS level in AI-generated reports. (d) Three senior radiologists evaluated reports generated by the AI system and reports written by one mid-level radiologist to determine the diagnostic level of AI-generated reports. (e) Three senior radiologists evaluated reports of junior radiologists with and without AI assistance to determine the value of the AI system to radiologists.


## train
To train the finding model, please use the following command:
```
python train_cnn.py  -image_folder data/image   -train_path  data/split/train.json  -val_path data/split/val.json
```

To train the impression model, please use the following command:
```
python train_cat.py  -image_folder data/image   -train_path  data/split/train.json  -val_path data/split/val.json
```

## inference
To test the finding model, please use the following command:
```
python translate_cnn.py  -image_folder data/image   -test_path  data/split/test.json -model your_finding_model_path.pth
```

To test the impression model, please use the following command:
```
python translate_cat.py  -image_folder data/image   -test_path  data/split/test.json -model your_impression_model_path.pth
```

## demo
Online [Demo](http://www.ai4busrg.com/) of automatically generated BUS reports and expert evaluation.

## preprocessing
A Chinese sentence is divided into multiple words using the following function:
```
def chinese_split(chinese_str):
    seg_list = jieba.cut(chinese_str, cut_all=False)
    seg_str = " ".join(seg_list)
    return seg_str
```
To use the above function, you need to install jieba firstï¼š
```
pip install jieba
```
## Acknowledgement
We implemented our transformer model with reference to [jadore801120](https://github.com/jadore801120/attention-is-all-you-need-pytorch/tree/master) and implemented the cider metric with reference to [brandontrabucco](https://github.com/brandontrabucco/cider). We thank them for their open source codes.
